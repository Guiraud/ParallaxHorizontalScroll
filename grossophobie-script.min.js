const PARALLAX_SCROLL_MULTIPLIER=.5,SCROLL_ANIMATION_DURATION=800,THEME_TOGGLE_ANIMATION_DURATION=300,ICONS={pen:"âœï¸",share:"ğŸ“¢","book-open":"ğŸ“–",message:"ğŸ’¬",heart:"â¤ï¸",default:"ğŸ“Œ"};let data=null,safeMode=!1;async function initializeApp(){await loadData(),setupEventListeners(),initThemeToggle(),initMobileMenu()}async function loadData(){try{if(window.THEME_DATA)data=window.THEME_DATA,console.log("âœ“ DonnÃ©es chargÃ©es depuis window.THEME_DATA");else{const e=window.THEME_NAME||"grossophobie",n=await fetch(`${e}.json`);data=await n.json(),console.log("âœ“ DonnÃ©es chargÃ©es depuis fichier JSON")}displayTriggerWarning()}catch(e){console.error("âœ— Erreur de chargement des donnÃ©es:",e),alert("Erreur lors du chargement des donnÃ©es. Veuillez rafraÃ®chir la page.")}}function displayTriggerWarning(){const e=document.getElementById("trigger-warning-text"),n=[`<p>${data.triggerWarning.global}</p>`,buildContactsHTML()];e.innerHTML=n.join(""),injectPetitionLink("#modal-petition-container")}function buildContactsHTML(){return`\n    <div style="margin-top: 1.5rem; text-align: left;">\n      <p><strong>Contacts d'aide en France :</strong></p>\n      ${data.triggerWarning.contacts.france.map(e=>`<p>â€¢ ${e.name} : <strong>${e.number}</strong> - ${e.description}</p>`).join("")}\n    </div>\n  `}function injectPetitionLink(e){const n=document.querySelector(e);if(!n||!data.meta?.petition?.url)return;const t=data.meta.petition;n.innerHTML=`\n    <a href="${t.url}"\n       target="_blank"\n       rel="noopener"\n       class="btn-petition-modal"\n       aria-label="${t.title||"Signer la pÃ©tition"}">\n      âœï¸ ${t.title||"Signer la PÃ©tition"}\n    </a>\n  `,console.log("âœ“ Lien de pÃ©tition ajoutÃ© dans",e)}function setupEventListeners(){setupModalListeners(),setupSafeModeListeners(),setupNavigationListeners()}function setupModalListeners(){$("#accept-warning").on("click",()=>{$("#trigger-warning-modal").removeClass("active"),renderAllSections()}),$("#safe-mode").on("click",()=>{safeMode=!0,$("#trigger-warning-modal").removeClass("active"),renderAllSections(),applySafeMode()})}function setupSafeModeListeners(){$("#safe-mode-toggle").on("change",function(){safeMode=this.checked,safeMode?applySafeMode():removeSafeMode()})}function setupNavigationListeners(){$(".nav-links a").on("click",function(e){e.preventDefault();smoothScrollToSection($(this).attr("href"))})}function renderAllSections(){[renderHero,renderParallaxImages,renderIntroduction,renderPublics,renderArguments,renderIMCCritique,renderPhrases,renderPositif,renderCampagnes,renderRessources,renderCTA,renderFooter,renderPetitionBadge].forEach(e=>e())}function renderHero(){$("#main-title").text(data.meta.title),$("#main-subtitle").text(data.meta.subtitle),$("#nav-title").text(data.meta.title||"")}function renderParallaxImages(){if(!data.parallaxImages?.enabled)return;const e=$("#hero");data.parallaxImages.images.forEach((n,t)=>{const i=createParallaxImageHTML(n,t);e.after(i)})}function createParallaxImageHTML(e,n){return`\n    <div class="img-wrapper ${e.speed||"normal"}" style="order: ${e.position||n}">\n      <a href="${e.url}" data-lightbox="parallax-images" data-title="${e.alt}">\n        <img src="${e.url}"\n             alt="${e.alt}"\n             loading="lazy"\n             style="max-width: 45vh; max-height: 50vh; border-radius: 15px; box-shadow: 0px 12px 50px rgba(0, 0, 0, 0.5);">\n      </a>\n    </div>\n  `}function renderIntroduction(){$("#intro-content").html(`<p>${data.introduction.content}</p>`);const e=data.introduction.statistics,n=`\n    <div class="stat-highlight-item">\n      <div class="stat-highlight-label">ğŸ‡«ğŸ‡· France</div>\n      <div class="stat-highlight-value">${e.france}</div>\n    </div>\n    <div class="stat-highlight-item">\n      <div class="stat-highlight-label">ğŸŒ Global</div>\n      <div class="stat-highlight-value">${e.global}</div>\n    </div>\n  `;$("#intro-stats").html(n)}function renderPublics(){const e=data.publicCibles.audiences.map(createPublicCardHTML).join("");$("#publics-grid").html(e)}function createPublicCardHTML(e){const n=e.resources.map(e=>`<li>${e}</li>`).join("");return`\n    <div class="public-card">\n      <div class="public-icon">${e.icon}</div>\n      <h3 class="public-name">${e.name}</h3>\n      <p class="public-message">${e.message}</p>\n      <div class="public-resources">\n        <ul>${n}</ul>\n      </div>\n    </div>\n  `}function renderArguments(){const e=data.arguments.items.map(createArgumentCardHTML).join("");$("#arguments-container").html(e),setupFlipCardListeners(),adjustFlipContainerHeights()}function createArgumentCardHTML(e){const n=e.sources?.length>0?createSourcesListHTML(e.sources):"";return`\n    <div class="argument-card" data-arg-id="${e.id}">\n      <h3 class="argument-title">${e.id}. ${e.title}</h3>\n\n      <div class="argument-flip-container">\n        ${createFlipCardFaceHTML("front",e.statFrance,"ğŸ‡«ğŸ‡·","us","Voir statistique Ã‰tats-Unis","ğŸ‡ºğŸ‡¸")}\n        ${createFlipCardFaceHTML("back",e.statUS,"ğŸ‡ºğŸ‡¸","fr","Voir statistique France","ğŸ‡«ğŸ‡·")}\n      </div>\n\n      <div class="argument-impact">\n        <strong>Impact :</strong> ${e.impact}\n      </div>\n\n      ${n}\n    </div>\n  `}function createFlipCardFaceHTML(e,n,t,i,a,s){return`\n    <div class="argument-face argument-face-${e}">\n      <div class="argument-stat-display">\n        <div class="stat-flag">${t}</div>\n        <div class="stat-value-main">${n}</div>\n      </div>\n      <button class="flip-flag-btn"\n              data-country="${i}"\n              aria-label="${a}">\n        <span class="flip-flag">${s}</span>\n      </button>\n    </div>\n  `}function createSourcesListHTML(e){return`\n    <div class="argument-sources">\n      <strong>ğŸ“š Sources :</strong>\n      <ul class="sources-list">${e.map(e=>`\n      <li>\n        <a href="${e.url}" target="_blank" rel="noopener" class="source-link">\n          ${e.title}\n        </a>\n      </li>\n    `).join("")}</ul>\n    </div>\n  `}function setupFlipCardListeners(){$(".flip-flag-btn").on("click",function(e){e.stopPropagation(),$(this).closest(".argument-card").toggleClass("flipped")})}function adjustFlipContainerHeights(){const e=e=>{const n=$(e),t=n.find(".argument-face-front").outerHeight(),i=n.find(".argument-face-back").outerHeight(),a=Math.max(t,i);n.css("min-height",`${a}px`)};$(".argument-flip-container").each(function(){e(this)}),$(window).on("resize",()=>{$(".argument-flip-container").each(function(){e(this)})})}function renderIMCCritique(){if(!data.imcCritique)return;const e=$("#imc-content");if(!e.length)return;const n=[renderIMCLimites(),renderIMCDimensionRaciale(),renderIMCAlternatives(),renderIMCRecommendations()];e.html(n.join("")),console.log("âœ“ Section IMC Critique rendue")}function renderIMCLimites(){return`\n    <div class="imc-section">\n      <h3 class="imc-section-title">ğŸ“Œ Principales Limites</h3>\n      <div class="imc-grid">${data.imcCritique.limites.map(e=>`\n      <div class="imc-card">\n        <div class="imc-card-icon">${e.icon}</div>\n        <h4 class="imc-card-title">${e.titre}</h4>\n        <p class="imc-card-description">${e.description}</p>\n      </div>\n    `).join("")}</div>\n    </div>\n  `}function renderIMCDimensionRaciale(){if(!data.imcCritique.dimensionRaciale)return"";const e=data.imcCritique.dimensionRaciale.points.map(e=>`<li>${e}</li>`).join("");return`\n    <div class="imc-section imc-raciale">\n      <h3 class="imc-section-title">ğŸŒ ${data.imcCritique.dimensionRaciale.titre}</h3>\n      <ul class="imc-list">${e}</ul>\n    </div>\n  `}function renderIMCAlternatives(){return`\n    <div class="imc-section">\n      <h3 class="imc-section-title">âœ¨ Alternatives et Mesures Plus Proches de la RÃ©alitÃ©</h3>\n      <div class="imc-alternatives">${data.imcCritique.alternatives.map(e=>`\n      <div class="imc-alternative">\n        <div class="imc-alt-header">\n          <span class="imc-alt-icon">${e.icon}</span>\n          <strong>${e.nom}</strong>\n        </div>\n        <p>${e.description}</p>\n      </div>\n    `).join("")}</div>\n    </div>\n  `}function renderIMCRecommendations(){return`\n    <div class="imc-section imc-recommendations">\n      <h3 class="imc-section-title">ğŸ’¡ Ce que Vous Pouvez Faire</h3>\n      <ul class="imc-list imc-action-list">${data.imcCritique.recommendations.map(e=>`<li>${e}</li>`).join("")}</ul>\n    </div>\n  `}function renderPhrases(){const e=data.phrasesDiscriminantes.items.map(createPhraseCardHTML).join("");$("#phrases-grid").html(e),setupPhraseCardListeners(),initTriggerContentToggle()}function createPhraseCardHTML(e){const n=e.sources?.length>0?createSourcesListHTML(e.sources):"";return`\n    <div class="phrase-card" data-id="${e.id}">\n      <div class="phrase-front">\n        <div class="phrase-categorie">${e.categorie}</div>\n        <p class="phrase-text">"${e.phrase}"</p>\n        <p class="flip-hint">Cliquez pour voir le dÃ©menti â†’</p>\n      </div>\n      <div class="phrase-back">\n        <p class="dementi-text">${e.dementi}</p>\n        ${n}\n        <p class="flip-hint">Cliquez pour revenir â†</p>\n      </div>\n    </div>\n  `}function setupPhraseCardListeners(){$(".phrase-card").on("click",function(){$(this).toggleClass("flipped")})}function initTriggerContentToggle(){const e=$("#toggle-trigger-content"),n=$("#phrases-grid"),t=e.find(".toggle-icon"),i=e.find(".toggle-text");let a=!1;e.on("click",()=>{a=!a,a?(n.addClass("trigger-hidden"),t.text("ğŸ‘ï¸â€ğŸ—¨ï¸"),i.text("Afficher"),e.attr("aria-label","Afficher le contenu sensible")):(n.removeClass("trigger-hidden"),t.text("ğŸ‘ï¸"),i.text("Masquer"),e.attr("aria-label","Masquer le contenu sensible"))})}function renderPositif(){const e=data.argumentsPositifs.items.map(e=>`\n      <div class="positif-card">\n        <h3 class="positif-title">${e.title}</h3>\n        <p class="positif-description">${e.description}</p>\n        <div class="positif-impact">âœ¨ ${e.impact}</div>\n      </div>\n    `).join("");$("#positif-grid").html(e)}function renderCampagnes(){const e=data.campagnesEfficaces.items.map(createCampagneCardHTML).join("");$("#campagnes-container").html(e)}function createCampagneCardHTML(e){const n=e.sources?.length>0?createSourcesListHTML(e.sources):"";return`\n    <div class="campagne-card">\n      <div class="campagne-header">\n        <h3 class="campagne-name">${e.name}</h3>\n        <div class="campagne-meta">\n          <span>ğŸ“… ${e.period}</span>\n          <span>ğŸŒ ${e.zone}</span>\n        </div>\n      </div>\n      <p class="campagne-description">${e.description}</p>\n      <div class="campagne-impact">\n        <strong>Impact :</strong> ${e.impact}\n      </div>\n      <p class="campagne-lecon"><strong>LeÃ§on :</strong> ${e.lecon}</p>\n      ${n}\n    </div>\n  `}function renderRessources(){const e=[renderRessourcesSection("Associations et Collectifs",data.ressources.associations,createAssociationItemHTML),renderRessourcesSection("Guides et Outils",data.ressources.guides,createGuideItemHTML),renderRessourcesSection("Livres et MÃ©dias",data.ressources.livres,createLivreItemHTML)].join("");$("#ressources-content").html(e)}function renderRessourcesSection(e,n,t){return`\n    <div class="ressources-section">\n      <h3>${e}</h3>\n      <ul class="ressources-list">${n.map(t).join("")}</ul>\n    </div>\n  `}function createAssociationItemHTML(e){const n=e.url?`<a href="${e.url}" target="_blank" rel="noopener" class="ressource-link">${e.name}</a>`:e.name,t=e.social?`<div style="color: var(--primary-color); margin-top: 0.5rem;">${e.social}</div>`:"";return`\n    <li class="ressource-item">\n      <div class="ressource-name">${n}</div>\n      <div class="ressource-type">${e.type}</div>\n      <div class="ressource-action">${e.action}</div>\n      ${t}\n    </li>\n  `}function createGuideItemHTML(e){return`\n    <li class="ressource-item">\n      <div class="ressource-name">${e.url?`<a href="${e.url}" target="_blank" rel="noopener" class="ressource-link">${e.titre}</a>`:e.titre}</div>\n      <div class="ressource-type">${e.source}</div>\n      <div class="ressource-action">${e.description}</div>\n    </li>\n  `}function createLivreItemHTML(e){return`\n    <li class="ressource-item">\n      <div class="ressource-name">${e.url?`<a href="${e.url}" target="_blank" rel="noopener" class="ressource-link">${e.titre}</a>`:e.titre}</div>\n      <div class="ressource-type">${e.source}</div>\n      <div class="ressource-action">${e.description}</div>\n    </li>\n  `}function renderCTA(){const e=data.callToAction.actions.map(createCTACardHTML).join("");$("#cta-grid").html(e),initCTAInteractions()}function createCTACardHTML(e){const n="primary"===e.type?"cta-card primary":"cta-card";if(e.interactive&&e.shareText)return createShareCardHTML(e,n);if(e.interactive&&e.ressources)return createFlipCardWithRessources(e,n);if(e.interactive&&e.personalities)return createFlipCardWithPersonalities(e,n);const t=e.url?`window.open('${e.url}', '_blank')`:"void(0)";return`\n    <div class="${n}"\n         data-url="${e.url||""}"\n         onclick="${t}">\n      <div class="cta-icon">${getIconForAction(e.icon)}</div>\n      <h3 class="cta-title">${e.titre}</h3>\n      <p class="cta-description">${e.description}</p>\n    </div>\n  `}function createShareCardHTML(e,n){return`\n    <div class="${n} cta-share-card">\n      <div class="cta-icon">${getIconForAction(e.icon)}</div>\n      <h3 class="cta-title">${e.titre}</h3>\n      <p class="cta-description">${e.description}</p>\n      <div class="share-buttons">\n        <button class="share-btn copy-url-btn" data-url="${e.url}" title="Copier le lien">\n          ğŸ”— Copier le lien\n        </button>\n        <button class="share-btn twitter-btn" data-text="${e.shareText}" title="Partager sur X/Twitter">\n          ğ• Twitter\n        </button>\n        <button class="share-btn facebook-btn" data-url="${e.url}" title="Partager sur Facebook">\n          ğŸ“˜ Facebook\n        </button>\n        <button class="share-btn linkedin-btn" data-url="${e.url}" data-text="${e.shareText}" title="Partager sur LinkedIn">\n          ğŸ’¼ LinkedIn\n        </button>\n      </div>\n    </div>\n  `}function createFlipCardWithRessources(e,n){const t=e.ressources.map(e=>`\n      <li class="ressource-flip-item">\n        <a href="${e.url}" target="_blank" rel="noopener">\n          ğŸ“š ${e.titre}\n        </a>\n        <span class="ressource-source">${e.source}</span>\n      </li>\n    `).join("");return`\n    <div class="${n} cta-flip-card">\n      <div class="flip-card-inner">\n        <div class="flip-card-front">\n          <div class="cta-icon">${getIconForAction(e.icon)}</div>\n          <h3 class="cta-title">${e.titre}</h3>\n          <p class="cta-description">${e.description}</p>\n          <button class="flip-card-btn">Voir les ressources â†’</button>\n        </div>\n        <div class="flip-card-back">\n          <h3 class="flip-back-title">Ressources pÃ©dagogiques</h3>\n          <ul class="ressources-flip-list">\n            ${t}\n          </ul>\n          <button class="flip-card-btn flip-back-btn">â† Retour</button>\n        </div>\n      </div>\n    </div>\n  `}function createFlipCardWithPersonalities(e,n){const t=e.personalities.map(e=>`\n      <li class="personality-item">\n        <a href="${e.url}" target="_blank" rel="noopener" class="personality-link">\n          <strong>${e.nom}</strong>\n          <span class="instagram-handle">${e.instagram}</span>\n        </a>\n        <p class="personality-description">${e.description}</p>\n      </li>\n    `).join("");return`\n    <div class="${n} cta-flip-card">\n      <div class="flip-card-inner">\n        <div class="flip-card-front">\n          <div class="cta-icon">${getIconForAction(e.icon)}</div>\n          <h3 class="cta-title">${e.titre}</h3>\n          <p class="cta-description">${e.description}</p>\n          <button class="flip-card-btn">DÃ©couvrir les comptes â†’</button>\n        </div>\n        <div class="flip-card-back">\n          <h3 class="flip-back-title">Comptes Instagram inspirants</h3>\n          <ul class="personalities-list">\n            ${t}\n          </ul>\n          <button class="flip-card-btn flip-back-btn">â† Retour</button>\n        </div>\n      </div>\n    </div>\n  `}function initCTAInteractions(){$(".copy-url-btn").on("click",function(e){e.stopPropagation();copyToClipboard($(this).data("url")),$(this).text("âœ“ CopiÃ© !").prop("disabled",!0),setTimeout(()=>{$(this).text("ğŸ”— Copier le lien").prop("disabled",!1)},2e3)}),$(".twitter-btn").on("click",function(e){e.stopPropagation();const n=$(this).data("text"),t=`https://twitter.com/intent/tweet?text=${encodeURIComponent(n)}`;window.open(t,"_blank")}),$(".facebook-btn").on("click",function(e){e.stopPropagation();const n=$(this).data("url"),t=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(n)}`;window.open(t,"_blank")}),$(".linkedin-btn").on("click",function(e){e.stopPropagation();const n=$(this).data("url"),t=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(n)}`;window.open(t,"_blank")}),$(".flip-card-btn").on("click",function(e){e.stopPropagation();$(this).closest(".cta-flip-card").toggleClass("flipped")})}function copyToClipboard(e){if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(e);else{const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){console.error("Erreur lors de la copie:",e)}document.body.removeChild(n)}}function renderFooter(){const e=`\n    <p>${data.footer.message}</p>\n    <p style="margin-top: 1rem; font-size: 0.9rem;">${data.footer.contact}</p>\n  `;$("#footer-content").html(e)}function renderPetitionBadge(){const e=$("#petition-badge"),n=data.meta?.petition;if(!n?.url)return e.hide(),void console.log("âœ— Aucune pÃ©tition dÃ©finie, badge masquÃ©");e.attr("href",n.url),e.attr("aria-label",n.title||"Signer la pÃ©tition"),n.title&&e.find(".badge-text").text("Signer la pÃ©tition"),e.on("click",()=>{console.log("âœ“ Clic sur le badge de pÃ©tition:",n.url)}),console.log("âœ“ Badge de pÃ©tition configurÃ©")}function applySafeMode(){console.log("ğŸ›¡ï¸ Mode sensible activÃ©"),$(".trigger-content").addClass("hidden-safe"),$(".trigger-section").css("opacity","0.5"),0===$("#safe-mode-message").length&&$("body").append(createSafeModeMessageHTML())}function createSafeModeMessageHTML(){return'\n    <div id="safe-mode-message" style="\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      background: var(--warning-color);\n      color: var(--bg-dark);\n      padding: 1rem 2rem;\n      border-radius: 10px;\n      font-weight: 600;\n      z-index: 9999;\n      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);\n    ">\n      ğŸ›¡ï¸ Mode sensible activÃ© - Contenus difficiles masquÃ©s\n    </div>\n  '}function removeSafeMode(){console.log("âœ“ Mode sensible dÃ©sactivÃ©"),$(".trigger-content").removeClass("hidden-safe"),$(".trigger-section").css("opacity","1"),$("#safe-mode-message").remove()}function initThemeToggle(){const e=document.getElementById("theme-toggle-btn");if(!e)return;const n=localStorage.getItem("theme")||"dark";applyTheme(n),e.addEventListener("click",handleThemeToggle),console.log("âœ“ Theme toggle initialisÃ©:",n)}function handleThemeToggle(){const e="dark"===(document.documentElement.getAttribute("data-theme")||"dark")?"light":"dark";applyTheme(e),localStorage.setItem("theme",e),animateThemeButton(this)}function animateThemeButton(e){e.style.transform="rotate(360deg)",setTimeout(()=>{e.style.transform="rotate(0deg)"},300)}function applyTheme(e){const n=document.querySelector(".theme-icon"),t=document.querySelector('link[href*="grossophobie-style"]');if(document.documentElement.setAttribute("data-theme",e),t){const i="light"===e;t.href=i?"grossophobie-style-light.css":"grossophobie-style.css",n&&(n.textContent=i?"â˜€ï¸":"ğŸŒ™")}console.log("âœ“ ThÃ¨me appliquÃ©:",e)}function detectSystemTheme(){return window.matchMedia?.("(prefers-color-scheme: dark)").matches?"dark":"light"}function initMobileMenu(){const e=document.getElementById("mobile-menu-toggle"),n=document.getElementById("nav-links");e&&n&&(e.addEventListener("click",()=>toggleMobileMenu(n,e)),setupMobileMenuNavigation(n,e),setupMobileMenuOutsideClick(n,e),console.log("âœ“ Menu mobile initialisÃ©"))}function toggleMobileMenu(e,n){e.classList.contains("active")?closeMobileMenu(e,n):openMobileMenu(e,n)}function openMobileMenu(e,n){e.classList.add("active"),n.classList.add("active"),document.body.style.overflow="hidden"}function closeMobileMenu(e,n){e.classList.remove("active"),n.classList.remove("active"),document.body.style.overflow=""}function setupMobileMenuNavigation(e,n){e.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>closeMobileMenu(e,n))})}function setupMobileMenuOutsideClick(e,n){document.addEventListener("click",t=>{!e.contains(t.target)&&!n.contains(t.target)&&e.classList.contains("active")&&closeMobileMenu(e,n)})}function getIconForAction(e){return ICONS[e]||ICONS.default}function smoothScrollToSection(e){const n=$(e);if(!n.length)return;const t=$(".horizontal-scroll-wrapper"),i=$(".section").index(n)*(.5*window.innerHeight);t.animate({scrollTop:i},800,"swing")}$(document).ready(function(){initializeApp()}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{const n=e.matches?"dark":"light";localStorage.getItem("theme")||applyTheme(n)}),$(window).on("resize",()=>{console.log("â†” Window resized")}),console.log("âœ“ Grossophobie Script chargÃ© et prÃªt");